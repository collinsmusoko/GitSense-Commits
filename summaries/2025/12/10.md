# Activity Summary for 10/12/2025

## 09:15:41
The `package.json` file for the `hrdirect-mcs-api` project, last modified at 09/12/2025, 13:02:01, outlines a Node.js REST API using an MCS (Model-Controller-Services) architecture. It specifies Node.js version 14.18.0 and npm >=6.14.15. The script section defines commands for starting the application in different environments (production, staging, dev) using `pm2` and `nodemon`, as well as commands for testing with `jest` (including coverage and watch modes), linting with `eslint`, formatting with `prettier`, and Docker orchestration (`docker-compose`). A wide array of dependencies are listed, including `@aws-sdk/client-s3`, `@azure/msal-node`, `bullmq`, `express`, `mongoose`, `jsonwebtoken`, `passport`, `nodemailer`, `socket.io`, `swagger-jsdoc`, `xlsx`, and various internal `@nathangroup` modules for HR functionalities like `apm`, `attendance`, `claim`, `leave`, `letter`, `payroll`, `ssomatrix`, and `wfh`. Development dependencies include `eslint`, `jest`, `nodemon`, `prettier`, and `supertest`.

The `/Users/collin/projects/hrms/hrdirect-admin/components/Bell.vue` component, responsible for displaying user notifications, underwent several saves/updates between 09/12/2025, 13:57:14 and 14:59:44.
- **Initial State (09/12/2025, 13:57:14 to 14:00:58):** The component provides a `v-menu` for a notification dropdown, showing a `v-badge` with the count of unread notifications. It lists unread notifications with an avatar, type, text, and date. Functionality includes marking all unread as read, infinite scrolling to load more, and routing to specific pages (`openUrl` method) when a notification is clicked. Navigation handles "Social notification" types by directing to `/user/home#social` with a `story_id`, and other types by navigating to a URL provided in the notification data, potentially adding `requestId` and `requestType` as query parameters.
- **Update (09/12/2025, 14:47:46):** The `openUrl` method was enhanced to include logic for correcting navigation hashes. It now maps old, non-existent tab hashes (e.g., 'leave', 'wfh', 'claim', 'attendance', 'lieu') to a generic 'requests' hash to ensure correct routing within the application. A `console.log` statement was added to debug notification click navigation.
- **Subsequent Saves (09/12/2025, 14:57:01 to 14:59:44):** The content of `Bell.vue` remained identical across these timestamps, indicating no further code changes were committed during this period.

The `/Users/collin/projects/hrms/hrdirect-mcs-api/src/services/leave_request.service.js` file, last seen at 09/12/2025, 14:28:19 and 15:00:29 (identical content), defines the backend logic for creating leave requests. This service handles:
- Retrieving user, manager, and approval flow data.
- Complex approval logic, including dynamic assignment of line/senior managers and deduplication of approvers to calculate required approval numbers.
- Validation of leave types, balances, and half-day eligibility.
- Integration with `@nathangroup/leave` for leave request creation.
- Management of `air_ticket` details for Annual Leaves.
- Calculation of `leave_salary_amount`.
- Logic for "Auto Approved" leaves where an approver has a substitute.

Similarly, the `/Users/collin/projects/hrms/hrdirect-mcs-api/src/services/wfh_request.service.js` file, last seen at 09/12/2025, 15:01:35 and 15:11:37 (identical content), manages Work From Home (WFH) requests. Key features include:
- Support for recurring WFH requests by generating multiple single requests.
- Fetching applicant, manager, and approval flow details.
- Dynamic approval logic, mirroring the leave request service, for assigning and deduplicating approvers.
- Integration with `@nathangroup/wfh` for WFH request creation.
- Saving WFH requests and managing an application log.
- Sending system notifications and emails to users and approvers upon request submission.
- A `withdrawWfhRequest` function to handle the withdrawal of WFH requests, updating statuses and sending relevant notifications/emails.

**Patterns and Recurring Elements:**
All changes occurred on 09/12/2025, indicating focused development activity on that day. There were numerous consecutive log entries for `Bell.vue` and the service files (`leave_request.service.js`, `wfh_request.service.js`) with identical content. This suggests frequent saving or committing without significant functional changes between these specific timestamps, except for one notable update in `Bell.vue` at 14:47:46. A strong pattern across both frontend and backend is the robust implementation of notification systems and multi-level approval workflows, including dynamic approver assignment and handling of "auto-approved" scenarios. The project leverages internal `@nathangroup` libraries, pointing to a modular and component-based development strategy for core HR functionalities. The system integrates frontend (Vue.js) and backend (Node.js) components extensively for features like notifications and request management.